buildscript {
  repositories {
    maven {
      url "https://plugins.gradle.org/m2/"
    }
  }
  dependencies {
    classpath "gradle.plugin.com.palantir.gradle.gitversion:gradle-git-version:0.5.2"
  }
}

apply plugin: 'groovy'
apply plugin: 'application'
apply plugin: 'com.palantir.git-version'

repositories {
    mavenCentral()
    jcenter()
    maven {
        url 'http://code.praqma.net/repo/maven/'
    }
}

dependencies {
    compile 'org.codehaus.groovy:groovy-all:2.4.4'
    compile 'org.slf4j:slf4j-api:1.7.21'
    compile 'net.praqma:cool:0.6.48'
    compile 'org.codehaus.groovy.modules.http-builder:http-builder:0.7.1'
    compile('org.jfrog.artifactory.client:artifactory-java-client-services:1.2.2'){
        exclude group: 'org.codehaus.groovy'
    }
    testCompile 'org.spockframework:spock-core:1.0-groovy-2.4'
}

def versionString = gitVersion()

task functionalTest(type: Test) {
    dependsOn('testClasses')
    include 'toGit/functional/**'
}

task uberjar(type: Jar) {
    dependsOn('compileGroovy')
    from files(sourceSets.main.output.classesDir)
    from configurations.runtime.asFileTree.files.collect { zipTree(it) }
    manifest {
        attributes 'Main-Class': 'toGit.Run'
    }
}

mainClassName='toGit.Run'

test {
    exclude 'toGit/functional/**'
}
